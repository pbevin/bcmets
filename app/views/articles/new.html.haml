%h1
  = @title || "Post a Message"
- form_for(@article) do |f|
  %fieldset
    = f.error_messages
    %div
      = f.label :name, "Name"
      %br
      = f.text_field :name
    %div
      = f.label :email, "Email"
      %br
      = f.text_field :email
    - if @article.reply?
      %div
        = f.hidden_field :to
        = f.hidden_field :parent_id
        = f.hidden_field :parent_msgid
        = f.label :reply_type, "Reply To:"
        %br
        = f.select :reply_type, [['List only', 'list'], ['Sender only', 'sender'], ['Both', 'both']]
    %div
      = f.label :subject, "Subject"
      %br
      = f.text_field :subject
    %div{:style => "display:none;"}
      = f.label :body, "Message:"
      %br
      = f.text_area :body, :rows => 15, :cols => 60
    %div
      = f.label :qt, "Message:"
      %br
      = f.text_area :qt, :rows => 15, :cols => 60
    %div.buttons
      = submit_tag "Post", :disable_with=>"Sending..."
      %button.quote Quote
    %pre#quoted= @quoted

:javascript
  var didQuote = false;
  $('.quote').click(function() {
    if (!didQuote) {
      $('#article_qt').val($('#article_qt').val() + "\n\n" + $('#quoted').text());
      didQuote = true;
    }
    return false;
  });
